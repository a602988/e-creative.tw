;(function($){var pluginName="scrollbar",defaults={axis:'y',wheel:true,wheelSpeed:40,wheelLock:true,scrollInvert:true,trackSize:false,thumbSize:false,resize:true,hideScrollbar:false,};function Plugin($container,options){var self=this;self.options=$.extend({},defaults,options);self._defaults=defaults;self._name=pluginName;(function(){var $thumb=$('<div class="thumb" />'),$track=$('<div class="track" />'),$scrollbar=$('<div class="scrollbar" />');$thumb.appendTo($track);$track.appendTo($scrollbar);$scrollbar.prependTo($container);if(self.options.hideScrollbar){$scrollbar.css('visibility','hidden');}}());var $viewport=$container.find(".viewport"),$scrollable=$container.find(".scrollable"),$scrollbar=$container.find(".scrollbar"),$track=$scrollbar.find(".track"),$thumb=$scrollbar.find(".thumb"),mousePosition=0,isHorizontal=this.options.axis==='x',hasTouchEvents="ontouchstart"in document.documentElement,sizeLabel=isHorizontal?"width":"height",posiLabel=isHorizontal?"left":"top",autoResize=this.options.resize;this.contentPosition=0;this.viewportSize=0;this.contentSize=0;this.contentRatio=0;this.trackSize=0;this.trackRatio=0;this.thumbSize=0;this.thumbPosition=0;function initialize(){self.update();setEvents();if(autoResize){$(window).bind('resize',self.resize);}
return self;}
this.destroy=function(){$(window).unbind('resize',self.resize);$track.unbind("mousedown",drag);$thumb.unbind("mousedown",start);$thumb.unbind("mouseup",end);$(document).unbind("mousemove",drag);$(document).unbind("mouseup",end);document.ontouchmove=document.ontouchend=null;delete self;};this.resize=function(){self.update('relative');};this.update=function(scrollTo){var sizeLabelCap=sizeLabel.charAt(0).toUpperCase()+sizeLabel.slice(1).toLowerCase();this.viewportSize=$viewport[0]['offset'+sizeLabelCap];this.contentSize=$scrollable[0]['scroll'+sizeLabelCap];this.contentRatio=this.viewportSize/this.contentSize;this.trackSize=this.options.trackSize||this.viewportSize;this.thumbSize=Math.min(this.trackSize,Math.max(0,(this.options.thumbSize||(this.trackSize*this.contentRatio))));this.trackRatio=this.options.thumbSize?(this.contentSize-this.viewportSize)/(this.trackSize-this.thumbSize):(this.contentSize/this.trackSize);$scrollbar.toggleClass("disable",this.contentRatio>=1);if(this.contentRatio>=1)scrollTo=0;switch(scrollTo){case"bottom":this.contentPosition=this.contentSize-this.viewportSize;break;case"relative":this.contentPosition=Math.min(this.contentSize-this.viewportSize,Math.max(0,this.contentPosition));break;default:this.contentPosition=parseInt(scrollTo,10)||0;}
setSize();};function scroll(target,direction,position,options){var properties={},easing='easeOutCirc';properties[direction]=position;target.stop().animate(properties,$.extend({duration:400,easing:$.easing&&$.easing[easing]?easing:'linear',},options));}
function setSize(){$thumb.css(posiLabel,self.contentPosition/self.trackRatio);$scrollable.css(posiLabel,-self.contentPosition);$scrollbar.css(sizeLabel,self.trackSize);$track.css(sizeLabel,self.trackSize);$thumb.css(sizeLabel,self.thumbSize);}
function setEvents(){if(hasTouchEvents){$viewport[0].ontouchstart=function(event){if(1===event.touches.length){start(event.touches[0]);event.stopPropagation();}};}else{$thumb.bind("mousedown",start);$track.bind("mousedown",drag);}
if(self.options.wheel&&window.addEventListener){$container[0].addEventListener("DOMMouseScroll",wheel,false);$container[0].addEventListener("mousewheel",wheel,false);}else if(self.options.wheel){$container[0].onmousewheel=wheel;}}
function start(event){$('body').css('user-select','none');mousePosition=isHorizontal?event.pageX:event.pageY;self.thumbPosition=parseInt($thumb.css(posiLabel),10)||0;if(hasTouchEvents){document.ontouchmove=function(event){event.preventDefault();drag(event.touches[0]);};document.ontouchend=end;}else{$(document).bind("mousemove",drag);$(document).bind("mouseup",end);$thumb.bind("mouseup",end);}}
function wheel(event){if(self.contentRatio<1){var eventObject=event||window.event,wheelSpeedDelta=eventObject.wheelDelta?eventObject.wheelDelta/120:-eventObject.detail/3;self.contentPosition-=wheelSpeedDelta*self.options.wheelSpeed;self.contentPosition=Math.min((self.contentSize-self.viewportSize),Math.max(0,self.contentPosition));$container.trigger("move");scroll($thumb,posiLabel,self.contentPosition/self.trackRatio);scroll($scrollable,posiLabel,-self.contentPosition);if(self.options.wheelLock||(self.contentPosition!==(self.contentSize-self.viewportSize)&&self.contentPosition!==0)){eventObject=$.event.fix(eventObject);eventObject.preventDefault();}}}
function drag(event){if(self.contentRatio<1){var mousePositionNew=isHorizontal?event.pageX:event.pageY,thumbPositionDelta=mousePositionNew-mousePosition;if(self.options.scrollInvert&&hasTouchEvents){thumbPositionDelta=mousePosition-mousePositionNew;}
var thumbPositionNew=Math.min((self.trackSize-self.thumbSize),Math.max(0,self.thumbPosition+thumbPositionDelta));self.contentPosition=thumbPositionNew*self.trackRatio;$container.trigger("move");scroll($thumb,posiLabel,thumbPositionNew);scroll($scrollable,posiLabel,-self.contentPosition);}}
function end(){$('body').css('user-select','auto');$(document).unbind("mousemove",drag);$(document).unbind("mouseup",end);$thumb.unbind("mouseup",end);document.ontouchmove=document.ontouchend=null;}
return initialize();}
$.fn[pluginName]=function(options){return this.each(function(){if(!$.data(this,'plugin_'+pluginName)){$.data(this,'plugin_'+pluginName,new Plugin($(this),options));}});};}((jQuery)));